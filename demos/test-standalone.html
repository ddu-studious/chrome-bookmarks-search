<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æµ®å±‚ UI ç‹¬ç«‹æµ‹è¯•</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px;
      color: white;
    }
    h1 { margin-bottom: 20px; }
    p { opacity: 0.9; margin-bottom: 30px; }
    .buttons {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      justify-content: center;
    }
    button {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s;
    }
    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .btn-spotlight {
      background: rgba(255,255,255,0.9);
      color: #007aff;
    }
    .btn-raycast {
      background: linear-gradient(135deg, #a855f7, #ec4899);
      color: white;
    }
    .btn-fluent {
      background: #0078d4;
      color: white;
    }
    .info {
      margin-top: 40px;
      background: rgba(255,255,255,0.15);
      padding: 20px;
      border-radius: 12px;
      max-width: 600px;
    }
    kbd {
      padding: 4px 8px;
      background: rgba(0,0,0,0.3);
      border-radius: 4px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <h1>ğŸ” æµ®å±‚ UI ç‹¬ç«‹æµ‹è¯•</h1>
  <p>æ­¤é¡µé¢ç”¨äºæµ‹è¯•æµ®å±‚ç»„ä»¶çš„ UI æ•ˆæœï¼ˆä¸ä¾èµ– Chrome æ‰©å±• APIï¼‰</p>
  
  <div class="buttons">
    <button class="btn-spotlight" onclick="showOverlay('spotlight')">Spotlight é£æ ¼</button>
    <button class="btn-raycast" onclick="showOverlay('raycast')">Raycast é£æ ¼</button>
    <button class="btn-fluent" onclick="showOverlay('fluent')">Fluent é£æ ¼</button>
  </div>
  
  <div class="info">
    <p><strong>æ“ä½œè¯´æ˜ï¼š</strong></p>
    <ul>
      <li>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æ‰“å¼€ä¸åŒé£æ ¼çš„æµ®å±‚</li>
      <li>æŒ‰ <kbd>Esc</kbd> æˆ–ç‚¹å‡»èƒŒæ™¯å…³é—­æµ®å±‚</li>
      <li>ä½¿ç”¨ <kbd>â†‘â†“</kbd> é”®é€‰æ‹©ç»“æœ</li>
      <li>ç‚¹å‡»å³ä¸‹è§’ ğŸ¨ æŒ‰é’®åˆ‡æ¢é£æ ¼</li>
    </ul>
    <p style="margin-top: 16px; opacity: 0.8;">
      <strong>æ³¨æ„ï¼š</strong>æ­¤æµ‹è¯•é¡µé¢ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ï¼Œå®é™…æœç´¢åŠŸèƒ½éœ€è¦åœ¨ Chrome ä¸­åŠ è½½æ‰©å±•åä½¿ç”¨ã€‚
    </p>
  </div>

  <script>
    // æ¨¡æ‹Ÿæ•°æ®
    const mockBookmarks = [
      { title: 'GitHub - Where the world builds software', url: 'https://github.com', visitCount: 256 },
      { title: 'Stack Overflow - Developer Community', url: 'https://stackoverflow.com', visitCount: 189 },
      { title: 'React â€“ A JavaScript library for building UIs', url: 'https://react.dev', visitCount: 145 },
      { title: 'MDN Web Docs', url: 'https://developer.mozilla.org', visitCount: 98 },
      { title: 'VS Code - Code editing. Redefined', url: 'https://code.visualstudio.com', visitCount: 76 }
    ];

    let overlayContainer = null;
    let shadowRoot = null;
    let currentStyle = 'spotlight';
    let isVisible = false;
    let selectedIndex = 0;

    function getStyles() {
      return `
        :host {
          --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          --overlay-width: 50vw;
          --overlay-min-width: 500px;
          --overlay-max-width: 700px;
          --overlay-max-height: 70vh;
          --transition-duration: 0.2s;
        }

        :host(.style-spotlight) {
          --bg-primary: rgba(255, 255, 255, 0.92);
          --bg-secondary: rgba(248, 249, 250, 0.95);
          --bg-hover: rgba(0, 0, 0, 0.04);
          --bg-active: #007aff;
          --text-primary: #1d1d1f;
          --text-secondary: #86868b;
          --text-active: #ffffff;
          --accent: #007aff;
          --accent-light: rgba(0, 122, 255, 0.1);
          --border: rgba(0, 0, 0, 0.08);
          --shadow: 0 22px 70px 4px rgba(0, 0, 0, 0.2);
          --blur: blur(30px);
          --radius: 16px;
          --radius-sm: 10px;
        }

        :host(.style-spotlight.dark) {
          --bg-primary: rgba(30, 30, 30, 0.92);
          --bg-secondary: rgba(45, 45, 45, 0.95);
          --bg-hover: rgba(255, 255, 255, 0.08);
          --text-primary: #f5f5f7;
          --text-secondary: #a1a1a6;
          --accent: #0a84ff;
          --accent-light: rgba(10, 132, 255, 0.15);
          --border: rgba(255, 255, 255, 0.1);
        }

        :host(.style-raycast) {
          --bg-primary: #18181b;
          --bg-secondary: #27272a;
          --bg-hover: #3f3f46;
          --bg-active: transparent;
          --text-primary: #fafafa;
          --text-secondary: #a1a1aa;
          --text-active: #fafafa;
          --accent: #a855f7;
          --accent-secondary: #ec4899;
          --accent-gradient: linear-gradient(135deg, #a855f7 0%, #ec4899 100%);
          --accent-light: rgba(168, 85, 247, 0.15);
          --border: rgba(255, 255, 255, 0.08);
          --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
          --blur: none;
          --radius: 12px;
          --radius-sm: 8px;
        }

        :host(.style-raycast.light) {
          --bg-primary: #ffffff;
          --bg-secondary: #f4f4f5;
          --bg-hover: #e4e4e7;
          --text-primary: #18181b;
          --text-secondary: #52525b;
          --border: rgba(0, 0, 0, 0.08);
          --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
        }

        :host(.style-fluent) {
          --bg-primary: rgba(243, 243, 243, 0.85);
          --bg-secondary: rgba(255, 255, 255, 0.7);
          --bg-hover: rgba(0, 0, 0, 0.03);
          --bg-active: rgba(0, 120, 212, 0.1);
          --text-primary: #1a1a1a;
          --text-secondary: #616161;
          --text-active: #0078d4;
          --accent: #0078d4;
          --accent-light: rgba(0, 120, 212, 0.1);
          --border: rgba(0, 0, 0, 0.06);
          --border-strong: rgba(0, 0, 0, 0.12);
          --shadow: 0 8px 16px rgba(0, 0, 0, 0.08);
          --blur: blur(20px);
          --radius: 8px;
          --radius-sm: 4px;
        }

        :host(.style-fluent.dark) {
          --bg-primary: rgba(32, 32, 32, 0.9);
          --bg-secondary: rgba(44, 44, 44, 0.8);
          --bg-hover: rgba(255, 255, 255, 0.05);
          --bg-active: rgba(96, 205, 255, 0.12);
          --text-primary: #ffffff;
          --text-secondary: #c5c5c5;
          --text-active: #60cdff;
          --accent: #60cdff;
          --accent-light: rgba(96, 205, 255, 0.12);
          --border: rgba(255, 255, 255, 0.06);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        .overlay-backdrop {
          position: fixed;
          top: 0; left: 0; right: 0; bottom: 0;
          background: rgba(0, 0, 0, 0.4);
          opacity: 0;
          visibility: hidden;
          transition: all var(--transition-duration) ease;
          z-index: 2147483646;
        }
        .overlay-backdrop.show { opacity: 1; visibility: visible; }

        .overlay-container {
          position: fixed;
          top: 50%; left: 50%;
          transform: translate(-50%, -50%) scale(0.95);
          width: var(--overlay-width);
          min-width: var(--overlay-min-width);
          max-width: var(--overlay-max-width);
          max-height: var(--overlay-max-height);
          background: var(--bg-primary);
          backdrop-filter: var(--blur);
          -webkit-backdrop-filter: var(--blur);
          border-radius: var(--radius);
          box-shadow: var(--shadow);
          border: 1px solid var(--border);
          overflow: hidden;
          display: flex;
          flex-direction: column;
          font-family: var(--font-family);
          opacity: 0;
          visibility: hidden;
          transition: all var(--transition-duration) ease;
          z-index: 2147483647;
        }
        .overlay-container.show {
          opacity: 1;
          visibility: visible;
          transform: translate(-50%, -50%) scale(1);
        }

        .search-area {
          padding: 16px 20px;
          border-bottom: 1px solid var(--border);
        }
        .search-box {
          display: flex;
          align-items: center;
          gap: 12px;
        }
        .search-icon {
          width: 20px; height: 20px;
          color: var(--text-secondary);
        }
        .search-input {
          flex: 1;
          border: none;
          background: transparent;
          font-size: 16px;
          color: var(--text-primary);
          outline: none;
        }
        .search-input::placeholder { color: var(--text-secondary); }
        .shortcut-badge {
          padding: 4px 8px;
          background: var(--bg-secondary);
          border-radius: 6px;
          font-size: 11px;
          color: var(--text-secondary);
          font-family: 'SF Mono', Monaco, monospace;
        }

        .mode-tabs {
          display: flex;
          gap: 2px;
          padding: 8px 12px;
          background: var(--bg-secondary);
          border-bottom: 1px solid var(--border);
        }
        .mode-tab {
          flex: 1;
          padding: 8px 12px;
          border: none;
          background: transparent;
          border-radius: var(--radius-sm);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          gap: 6px;
          font-size: 13px;
          color: var(--text-secondary);
          transition: all 0.15s ease;
          font-family: inherit;
        }
        .mode-tab:hover {
          background: var(--bg-hover);
          color: var(--text-primary);
        }
        .mode-tab.active {
          background: var(--bg-primary);
          color: var(--accent);
          font-weight: 500;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        }
        .mode-tab svg { width: 16px; height: 16px; }
        .tab-count {
          padding: 2px 6px;
          background: var(--bg-hover);
          border-radius: 10px;
          font-size: 10px;
          font-weight: 600;
        }
        .mode-tab.active .tab-count {
          background: var(--accent-light);
          color: var(--accent);
        }

        .results-container {
          flex: 1;
          overflow-y: auto;
          min-height: 200px;
          max-height: 400px;
          padding: 8px;
        }

        .result-item {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 10px 12px;
          border-radius: var(--radius-sm);
          cursor: pointer;
          transition: all 0.1s ease;
          position: relative;
        }
        .result-item:hover { background: var(--bg-hover); }
        .result-item.active { background: var(--bg-active); }

        :host(.style-spotlight) .result-item.active {
          background: var(--accent);
        }
        :host(.style-spotlight) .result-item.active .result-title,
        :host(.style-spotlight) .result-item.active .result-url,
        :host(.style-spotlight) .result-item.active .meta-badge {
          color: white !important;
        }

        :host(.style-raycast) .result-item::before {
          content: '';
          position: absolute;
          left: 0; top: 50%;
          transform: translateY(-50%);
          width: 3px; height: 0;
          background: var(--accent-gradient);
          border-radius: 2px;
          transition: height 0.15s ease;
        }
        :host(.style-raycast) .result-item:hover::before,
        :host(.style-raycast) .result-item.active::before {
          height: 24px;
        }

        :host(.style-fluent) .result-item.active {
          border: 1px solid var(--accent);
          background: var(--accent-light);
        }

        .result-icon {
          width: 36px; height: 36px;
          border-radius: 8px;
          background: var(--bg-secondary);
          display: flex;
          align-items: center;
          justify-content: center;
          overflow: hidden;
        }
        .result-icon img { width: 20px; height: 20px; }

        .result-content { flex: 1; min-width: 0; }
        .result-title {
          font-size: 14px;
          font-weight: 500;
          color: var(--text-primary);
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .result-url {
          font-size: 12px;
          color: var(--text-secondary);
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
          margin-top: 2px;
        }
        .meta-badge {
          padding: 3px 8px;
          background: var(--accent-light);
          border-radius: 10px;
          font-size: 11px;
          color: var(--accent);
          font-weight: 500;
        }

        .status-bar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 10px 16px;
          background: var(--bg-secondary);
          border-top: 1px solid var(--border);
          font-size: 12px;
          color: var(--text-secondary);
        }
        .keyboard-hints { display: flex; gap: 12px; }
        .hint { display: flex; align-items: center; gap: 4px; }
        .hint kbd {
          padding: 2px 6px;
          background: var(--bg-primary);
          border-radius: 4px;
          font-family: 'SF Mono', Monaco, monospace;
          font-size: 11px;
          box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        .style-switcher {
          width: 28px; height: 28px;
          border: none;
          background: var(--bg-hover);
          border-radius: var(--radius-sm);
          color: var(--text-secondary);
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-left: 8px;
        }
        .style-switcher:hover {
          background: var(--accent-light);
          color: var(--accent);
        }
      `;
    }

    function getHTML() {
      const items = mockBookmarks.map((b, i) => {
        const active = i === selectedIndex ? 'active' : '';
        const hostname = new URL(b.url).hostname;
        return `
          <div class="result-item ${active}" data-index="${i}">
            <div class="result-icon">
              <img src="https://www.google.com/s2/favicons?domain=${hostname}&sz=32" onerror="this.style.display='none'">
            </div>
            <div class="result-content">
              <div class="result-title">${b.title}</div>
              <div class="result-url">${b.url}</div>
            </div>
            <span class="meta-badge">${b.visitCount}æ¬¡</span>
          </div>
        `;
      }).join('');

      return `
        <style>${getStyles()}</style>
        <div class="overlay-backdrop" id="backdrop"></div>
        <div class="overlay-container" id="searchPanel">
          <div class="search-area">
            <div class="search-box">
              <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
              </svg>
              <input type="text" class="search-input" id="searchInput" placeholder="æœç´¢ä¹¦ç­¾ã€æ ‡ç­¾é¡µã€å†å²è®°å½•..." autocomplete="off">
              <span class="shortcut-badge">Alt+B</span>
            </div>
          </div>
          <div class="mode-tabs">
            <button class="mode-tab active" data-mode="bookmarks">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/></svg>
              <span>ä¹¦ç­¾</span>
              <span class="tab-count">${mockBookmarks.length}</span>
            </button>
            <button class="mode-tab" data-mode="tabs">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M21 3H3c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H3V5h18v14z"/></svg>
              <span>æ ‡ç­¾é¡µ</span>
              <span class="tab-count">0</span>
            </button>
            <button class="mode-tab" data-mode="history">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42A8.954 8.954 0 0013 21c4.97 0 9-4.03 9-9s-4.03-9-9-9z"/></svg>
              <span>å†å²</span>
              <span class="tab-count">0</span>
            </button>
            <button class="mode-tab" data-mode="downloads">
              <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
              <span>ä¸‹è½½</span>
              <span class="tab-count">0</span>
            </button>
          </div>
          <div class="results-container">${items}</div>
          <div class="status-bar">
            <span>æ‰¾åˆ° ${mockBookmarks.length} ä¸ªç»“æœ</span>
            <div class="keyboard-hints">
              <span class="hint"><kbd>â†‘â†“</kbd> é€‰æ‹©</span>
              <span class="hint"><kbd>â†µ</kbd> æ‰“å¼€</span>
              <span class="hint"><kbd>Esc</kbd> å…³é—­</span>
            </div>
            <button class="style-switcher" id="styleSwitcher" title="åˆ‡æ¢æ ·å¼">
              <svg viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
                <path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/>
              </svg>
            </button>
          </div>
        </div>
      `;
    }

    function createOverlay() {
      if (overlayContainer) {
        document.body.removeChild(overlayContainer);
      }
      overlayContainer = document.createElement('div');
      overlayContainer.id = 'bookmark-search-test';
      shadowRoot = overlayContainer.attachShadow({ mode: 'closed' });
      shadowRoot.innerHTML = getHTML();
      document.body.appendChild(overlayContainer);

      // ç»‘å®šäº‹ä»¶
      shadowRoot.getElementById('backdrop').addEventListener('click', hideOverlay);
      shadowRoot.getElementById('styleSwitcher').addEventListener('click', cycleStyle);
      shadowRoot.getElementById('searchInput').addEventListener('keydown', handleKeydown);
    }

    function setStyle(style) {
      currentStyle = style;
      overlayContainer.className = `style-${style}`;
      const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      if (isDark && (style === 'spotlight' || style === 'fluent')) {
        overlayContainer.classList.add('dark');
      } else if (!isDark && style === 'raycast') {
        overlayContainer.classList.add('light');
      }
    }

    function cycleStyle() {
      const styles = ['spotlight', 'raycast', 'fluent'];
      const next = styles[(styles.indexOf(currentStyle) + 1) % styles.length];
      setStyle(next);
    }

    function showOverlay(style) {
      createOverlay();
      setStyle(style || currentStyle);
      shadowRoot.getElementById('backdrop').classList.add('show');
      shadowRoot.getElementById('searchPanel').classList.add('show');
      isVisible = true;
      setTimeout(() => shadowRoot.getElementById('searchInput').focus(), 100);
    }

    function hideOverlay() {
      if (!shadowRoot) return;
      shadowRoot.getElementById('backdrop').classList.remove('show');
      shadowRoot.getElementById('searchPanel').classList.remove('show');
      isVisible = false;
    }

    function handleKeydown(e) {
      if (e.key === 'Escape') {
        hideOverlay();
      } else if (e.key === 'ArrowDown') {
        e.preventDefault();
        selectedIndex = Math.min(selectedIndex + 1, mockBookmarks.length - 1);
        updateSelection();
      } else if (e.key === 'ArrowUp') {
        e.preventDefault();
        selectedIndex = Math.max(selectedIndex - 1, 0);
        updateSelection();
      }
    }

    function updateSelection() {
      const items = shadowRoot.querySelectorAll('.result-item');
      items.forEach((item, i) => {
        item.classList.toggle('active', i === selectedIndex);
        if (i === selectedIndex) item.scrollIntoView({ block: 'nearest' });
      });
    }

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && isVisible) hideOverlay();
    });
  </script>
</body>
</html>
